<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Global UPC - Barcode Management</title>
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 32 32'%3E%3Crect x='2' y='8' width='2' height='16' fill='%23000000'/%3E%3Crect x='6' y='8' width='1' height='16' fill='%23000000'/%3E%3Crect x='9' y='8' width='3' height='16' fill='%23000000'/%3E%3Crect x='14' y='8' width='1' height='16' fill='%23000000'/%3E%3Crect x='17' y='8' width='2' height='16' fill='%23000000'/%3E%3Crect x='21' y='8' width='1' height='16' fill='%23000000'/%3E%3Crect x='24' y='8' width='2' height='16' fill='%23000000'/%3E%3Crect x='28' y='8' width='2' height='16' fill='%23000000'/%3E%3C/svg%3E" />
    <link rel="stylesheet" href="styles.css" />
  </head>
  <body>
    <div class="container">
      <!-- Sidebar Navigation -->
      <aside class="sidebar">
        <div class="logo">
          <svg
            width="32"
            height="32"
            viewBox="0 0 32 32"
            fill="none"
            xmlns="http://www.w3.org/2000/svg"
          >
            <rect x="2" y="8" width="2" height="16" fill="currentColor" />
            <rect x="6" y="8" width="1" height="16" fill="currentColor" />
            <rect x="9" y="8" width="3" height="16" fill="currentColor" />
            <rect x="14" y="8" width="1" height="16" fill="currentColor" />
            <rect x="17" y="8" width="2" height="16" fill="currentColor" />
            <rect x="21" y="8" width="1" height="16" fill="currentColor" />
            <rect x="24" y="8" width="2" height="16" fill="currentColor" />
            <rect x="28" y="8" width="2" height="16" fill="currentColor" />
          </svg>
          <h1>Global UPC</h1>
        </div>
        <nav class="nav">
          <a href="#" class="nav-item active" data-page="dashboard">
            <span>Dashboard</span>
          </a>
          <a href="#" class="nav-item" data-page="update-upc">
            <span>Update UPC</span>
          </a>
          <a href="#" class="nav-item" data-page="sql-audit">
            <span>Orphan UPCs</span>
          </a>
          <a href="#" class="nav-item" data-page="store-comparison">
            <span>Items Check</span>
          </a>
          <a href="#" class="nav-item" data-page="history">
            <span>History</span>
          </a>
          <a href="#" class="nav-item" data-page="settings">
            <span>Settings</span>
          </a>
        </nav>
      </aside>

      <!-- Main Content -->
      <main class="main-content">
        <!-- Dashboard Page -->
        <div id="dashboard-page" class="page">
          <header class="page-header">
            <h2>Dashboard</h2>
            <p class="subtitle">
              Monitor and manage your UPC barcodes across all stores
            </p>
          </header>
          <div class="dashboard-content">
            <div class="stats-grid">
              <div class="stat-card">
                <div class="stat-icon">
                  <svg
                    width="24"
                    height="24"
                    viewBox="0 0 24 24"
                    fill="none"
                    xmlns="http://www.w3.org/2000/svg"
                  >
                    <path
                      d="M20 7L12 3L4 7M20 7L12 11M20 7V17L12 21M12 11L4 7M12 11V21M4 7V17L12 21"
                      stroke="currentColor"
                      stroke-width="2"
                      stroke-linecap="round"
                      stroke-linejoin="round"
                    />
                  </svg>
                </div>
                <div class="stat-info">
                  <p class="stat-label">Total Stores</p>
                  <p class="stat-value" id="total-stores">0</p>
                </div>
              </div>
              <div class="stat-card">
                <div class="stat-icon">
                  <svg
                    width="24"
                    height="24"
                    viewBox="0 0 24 24"
                    fill="none"
                    xmlns="http://www.w3.org/2000/svg"
                  >
                    <rect
                      x="3"
                      y="6"
                      width="2"
                      height="12"
                      stroke="currentColor"
                      stroke-width="2"
                    />
                    <rect
                      x="7"
                      y="6"
                      width="1"
                      height="12"
                      stroke="currentColor"
                      stroke-width="2"
                    />
                    <rect
                      x="10"
                      y="6"
                      width="2"
                      height="12"
                      stroke="currentColor"
                      stroke-width="2"
                    />
                    <rect
                      x="14"
                      y="6"
                      width="1"
                      height="12"
                      stroke="currentColor"
                      stroke-width="2"
                    />
                    <rect
                      x="17"
                      y="6"
                      width="2"
                      height="12"
                      stroke="currentColor"
                      stroke-width="2"
                    />
                    <rect
                      x="21"
                      y="6"
                      width="1"
                      height="12"
                      stroke="currentColor"
                      stroke-width="2"
                    />
                  </svg>
                </div>
                <div class="stat-info">
                  <p class="stat-label">Active Connections</p>
                  <p class="stat-value" id="active-stores">0</p>
                </div>
              </div>
            </div>

            <!-- Tools Section -->
            <section style="margin-top: 2rem">
              <h3
                style="
                  margin: 0 0 1rem 0;
                  font-size: 1.125rem;
                  color: var(--text-primary);
                "
              >
                Available Tools
              </h3>
              <div
                style="
                  display: grid;
                  grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
                  gap: 1rem;
                "
              >
                <a href="#" class="tool-card" data-page="update-upc">
                  <div class="tool-icon">
                    <svg
                      width="32"
                      height="32"
                      viewBox="0 0 32 32"
                      fill="none"
                      xmlns="http://www.w3.org/2000/svg"
                    >
                      <rect
                        x="4"
                        y="10"
                        width="3"
                        height="12"
                        stroke="currentColor"
                        stroke-width="2"
                      />
                      <rect
                        x="9"
                        y="10"
                        width="2"
                        height="12"
                        stroke="currentColor"
                        stroke-width="2"
                      />
                      <rect
                        x="14"
                        y="10"
                        width="3"
                        height="12"
                        stroke="currentColor"
                        stroke-width="2"
                      />
                      <rect
                        x="20"
                        y="10"
                        width="2"
                        height="12"
                        stroke="currentColor"
                        stroke-width="2"
                      />
                      <rect
                        x="25"
                        y="10"
                        width="3"
                        height="12"
                        stroke="currentColor"
                        stroke-width="2"
                      />
                    </svg>
                  </div>
                  <div class="tool-info">
                    <h4>Update UPC</h4>
                    <p>
                      Search and update UPC barcodes across all connected stores
                    </p>
                  </div>
                </a>
                <a href="#" class="tool-card" data-page="sql-audit">
                  <div class="tool-icon">
                    <svg
                      width="32"
                      height="32"
                      viewBox="0 0 32 32"
                      fill="none"
                      xmlns="http://www.w3.org/2000/svg"
                    >
                      <path
                        d="M16 4L4 8V14C4 21 9 27 16 28C23 27 28 21 28 14V8L16 4Z"
                        stroke="currentColor"
                        stroke-width="2"
                        stroke-linecap="round"
                        stroke-linejoin="round"
                        fill="none"
                      />
                      <path
                        d="M12 16L15 19L21 13"
                        stroke="currentColor"
                        stroke-width="2"
                        stroke-linecap="round"
                        stroke-linejoin="round"
                      />
                    </svg>
                  </div>
                  <div class="tool-info">
                    <h4>Orphan UPCs</h4>
                    <p>Validate UPC data integrity across SQL databases</p>
                  </div>
                </a>
              </div>
            </section>
          </div>
        </div>

        <!-- Settings Page -->
        <div id="settings-page" class="page" style="display: none">
          <header class="page-header">
            <h2>Settings</h2>
            <p class="subtitle">
              Configure your store connections and preferences
            </p>
          </header>

          <!-- Stores Section -->
          <section class="settings-section">
            <div class="section-header">
              <h3>Store Connections</h3>
              <div class="button-group">
                <button class="btn btn-primary" id="add-mssql-btn">
                  <svg
                    width="16"
                    height="16"
                    viewBox="0 0 16 16"
                    fill="none"
                    xmlns="http://www.w3.org/2000/svg"
                  >
                    <path
                      d="M8 3V13M3 8H13"
                      stroke="currentColor"
                      stroke-width="2"
                      stroke-linecap="round"
                    />
                  </svg>
                  Add MSSQL Database
                </button>
                <button class="btn btn-primary" id="add-shopify-btn">
                  <svg
                    width="16"
                    height="16"
                    viewBox="0 0 16 16"
                    fill="none"
                    xmlns="http://www.w3.org/2000/svg"
                  >
                    <path
                      d="M8 3V13M3 8H13"
                      stroke="currentColor"
                      stroke-width="2"
                      stroke-linecap="round"
                    />
                  </svg>
                  Add Shopify Store
                </button>
                <button class="btn btn-secondary" id="export-config-btn">
                  <svg
                    width="16"
                    height="16"
                    viewBox="0 0 16 16"
                    fill="none"
                    xmlns="http://www.w3.org/2000/svg"
                  >
                    <path
                      d="M8 2V10M8 10L5 7M8 10L11 7"
                      stroke="currentColor"
                      stroke-width="2"
                      stroke-linecap="round"
                      stroke-linejoin="round"
                    />
                    <path
                      d="M2 12V13C2 13.5523 2.44772 14 3 14H13C13.5523 14 14 13.5523 14 13V12"
                      stroke="currentColor"
                      stroke-width="2"
                      stroke-linecap="round"
                    />
                  </svg>
                  Export
                </button>
                <button class="btn btn-secondary" id="import-config-btn">
                  <svg
                    width="16"
                    height="16"
                    viewBox="0 0 16 16"
                    fill="none"
                    xmlns="http://www.w3.org/2000/svg"
                  >
                    <path
                      d="M8 10V2M8 2L5 5M8 2L11 5"
                      stroke="currentColor"
                      stroke-width="2"
                      stroke-linecap="round"
                      stroke-linejoin="round"
                    />
                    <path
                      d="M2 12V13C2 13.5523 2.44772 14 3 14H13C13.5523 14 14 13.5523 14 13V12"
                      stroke="currentColor"
                      stroke-width="2"
                      stroke-linecap="round"
                    />
                  </svg>
                  Import
                </button>
              </div>
            </div>
            <div id="stores-list" class="stores-list"></div>
            <!-- Hidden file input for import -->
            <input
              type="file"
              id="import-config-file"
              accept=".json"
              style="display: none"
            />
          </section>

          <!-- User Preferences Section -->
          <section class="settings-section">
            <div class="section-header">
              <h3>User Preferences</h3>
            </div>
            <div class="form-group">
              <label for="default-landing-page">Default Landing Page</label>
              <select id="default-landing-page" style="max-width: 300px">
                <option value="dashboard">Dashboard</option>
                <option value="update-upc">Update UPC</option>
                <option value="sql-audit">Orphan UPCs</option>
                <option value="store-comparison">Items Check</option>
                <option value="history">History</option>
                <option value="settings">Settings</option>
              </select>
              <small
                style="
                  color: var(--text-tertiary);
                  font-size: 0.75rem;
                  margin-top: 0.5rem;
                  display: block;
                "
              >
                Choose which page loads when you visit the application. This
                setting is saved locally on your device.
              </small>
            </div>
          </section>

          <!-- Theme Selector Section -->
          <section class="settings-section">
            <div class="section-header">
              <h3>Color Theme</h3>
            </div>
            <div class="theme-selector">
              <div class="theme-option" data-theme-name="current">
                <div class="theme-preview">
                  <div class="theme-colors">
                    <span style="background: #0a0a0f"></span>
                    <span style="background: #121218"></span>
                    <span style="background: #1a1a24"></span>
                    <span style="background: #6366f1"></span>
                  </div>
                </div>
                <div class="theme-info">
                  <div class="theme-name">Current (Purple Accent)</div>
                  <div class="theme-description">
                    Original rainbow gradient theme
                  </div>
                </div>
              </div>

              <div class="theme-option" data-theme-name="monochrome">
                <div class="theme-preview">
                  <div class="theme-colors">
                    <span style="background: #0d0d0d"></span>
                    <span style="background: #171717"></span>
                    <span style="background: #1f1f1f"></span>
                    <span style="background: #e5e5e5"></span>
                  </div>
                </div>
                <div class="theme-info">
                  <div class="theme-name">Monochrome Slate</div>
                  <div class="theme-description">
                    Pure grayscale, corporate feel
                  </div>
                </div>
              </div>

              <div class="theme-option" data-theme-name="charcoal">
                <div class="theme-preview">
                  <div class="theme-colors">
                    <span style="background: #0f0e0e"></span>
                    <span style="background: #1a1918"></span>
                    <span style="background: #242321"></span>
                    <span style="background: #d4d2cf"></span>
                  </div>
                </div>
                <div class="theme-info">
                  <div class="theme-name">Charcoal Gray</div>
                  <div class="theme-description">
                    Warm undertones, sophisticated
                  </div>
                </div>
              </div>

              <div class="theme-option" data-theme-name="steel">
                <div class="theme-preview">
                  <div class="theme-colors">
                    <span style="background: #0e0f11"></span>
                    <span style="background: #16181b"></span>
                    <span style="background: #1e2125"></span>
                    <span style="background: #cbd5e0"></span>
                  </div>
                </div>
                <div class="theme-info">
                  <div class="theme-name">Steel Gray</div>
                  <div class="theme-description">
                    Cool blue undertones, technical
                  </div>
                </div>
              </div>

              <div class="theme-option" data-theme-name="minimal">
                <div class="theme-preview">
                  <div class="theme-colors">
                    <span style="background: #121214"></span>
                    <span style="background: #1a1a1d"></span>
                    <span style="background: #222226"></span>
                    <span style="background: #c8c8cc"></span>
                  </div>
                </div>
                <div class="theme-info">
                  <div class="theme-name">Minimal Contrast</div>
                  <div class="theme-description">
                    Low contrast, easy on eyes
                  </div>
                </div>
              </div>

              <div class="theme-option" data-theme-name="graphite">
                <div class="theme-preview">
                  <div class="theme-colors">
                    <span style="background: #000000"></span>
                    <span style="background: #0a0a0a"></span>
                    <span style="background: #141414"></span>
                    <span style="background: #f5f5f5"></span>
                  </div>
                </div>
                <div class="theme-info">
                  <div class="theme-name">Dark Graphite</div>
                  <div class="theme-description">
                    True black, maximum contrast
                  </div>
                </div>
              </div>
            </div>
          </section>
        </div>

        <!-- Update UPC Page -->
        <div id="update-upc-page" class="page" style="display: none">
          <header class="page-header">
            <h2>Update UPC</h2>
            <p class="subtitle">
              Search and update UPC barcodes across all connected stores
            </p>
          </header>

          <div class="settings-section">
            <!-- Search Section with Update Input -->
            <div class="form-group">
              <label for="upc-search-input">Enter UPC to Search</label>
              <div style="display: flex; gap: 0.75rem; align-items: stretch">
                <input
                  type="text"
                  id="upc-search-input"
                  placeholder="Enter UPC/barcode to search"
                  style="width: 240px"
                />
                <div id="new-upc-container" style="display: none; width: 240px">
                  <input
                    type="text"
                    id="new-upc-input"
                    placeholder="Enter new UPC/barcode"
                    style="width: 100%; height: 100%"
                  />
                </div>
                <button
                  type="button"
                  class="btn btn-primary"
                  id="search-upc-btn"
                >
                  Search
                </button>
                <button
                  type="button"
                  class="btn btn-primary"
                  id="update-all-btn"
                  disabled
                  style="display: none"
                >
                  Update All
                </button>
              </div>
            </div>

            <!-- Loading State with Progress -->
            <div
              id="upc-search-loading"
              class="test-status"
              style="display: none; margin-top: 1.5rem"
            >
              <div class="loading">Searching across all stores...</div>
              <div
                id="search-progress"
                style="
                  margin-top: 1rem;
                  padding: 1rem;
                  background: var(--bg-tertiary);
                  border-radius: var(--radius-md);
                  display: none;
                  max-height: 200px;
                  overflow-y: auto;
                "
              >
                <div
                  id="progress-items"
                  style="display: flex; flex-direction: column; gap: 0.5rem"
                ></div>
              </div>
            </div>

            <!-- Empty State -->
            <div
              id="upc-search-empty"
              style="
                display: none;
                text-align: center;
                padding: 3rem 1rem;
                color: var(--text-tertiary);
                margin-top: 1.5rem;
              "
            >
              <svg
                width="48"
                height="48"
                viewBox="0 0 48 48"
                fill="none"
                xmlns="http://www.w3.org/2000/svg"
                style="margin: 0 auto 1rem"
              >
                <rect
                  x="6"
                  y="14"
                  width="4"
                  height="20"
                  stroke="currentColor"
                  stroke-width="2"
                />
                <rect
                  x="13"
                  y="14"
                  width="2"
                  height="20"
                  stroke="currentColor"
                  stroke-width="2"
                />
                <rect
                  x="19"
                  y="14"
                  width="4"
                  height="20"
                  stroke="currentColor"
                  stroke-width="2"
                />
                <rect
                  x="27"
                  y="14"
                  width="2"
                  height="20"
                  stroke="currentColor"
                  stroke-width="2"
                />
                <rect
                  x="33"
                  y="14"
                  width="4"
                  height="20"
                  stroke="currentColor"
                  stroke-width="2"
                />
                <rect
                  x="41"
                  y="14"
                  width="2"
                  height="20"
                  stroke="currentColor"
                  stroke-width="2"
                />
              </svg>
              <p style="margin: 0; font-size: 0.875rem">
                No products found with this UPC
              </p>
              <p style="margin: 0.5rem 0 0; font-size: 0.75rem">
                Try searching for a different barcode
              </p>
            </div>

            <!-- Results Section -->
            <div
              id="upc-search-results"
              style="display: none; margin-top: 1.5rem"
            >
              <div style="margin-bottom: 1rem">
                <p
                  style="
                    margin: 0;
                    font-size: 0.875rem;
                    color: var(--text-secondary);
                  "
                >
                  <strong id="upc-results-count">0</strong> products found
                  across <strong id="upc-stores-count">0</strong> stores
                </p>
              </div>
              <div style="overflow-x: auto">
                <table class="data-table">
                  <thead>
                    <tr>
                      <th style="width: 18%">Store Name</th>
                      <th>Product Title</th>
                      <th style="width: 25%">Variant</th>
                    </tr>
                  </thead>
                  <tbody id="upc-results-table-body">
                    <!-- Results will be populated here by JavaScript -->
                  </tbody>
                </table>
              </div>
            </div>

            <!-- Update Progress Section -->
            <div
              id="upc-update-section"
              style="
                display: none;
                margin-top: 2rem;
                padding-top: 2rem;
                border-top: 1px solid var(--border-color);
              "
            >
              <!-- Update Progress -->
              <div
                id="upc-update-loading"
                class="test-status"
                style="display: none; margin-top: 1.5rem"
              >
                <div class="loading">Updating UPC across all stores...</div>
                <div
                  id="update-progress"
                  style="
                    margin-top: 1rem;
                    padding: 1rem;
                    background: var(--bg-tertiary);
                    border-radius: var(--radius-md);
                    display: none;
                    max-height: 200px;
                    overflow-y: auto;
                  "
                >
                  <div
                    id="update-progress-items"
                    style="display: flex; flex-direction: column; gap: 0.5rem"
                  ></div>
                </div>
              </div>

              <!-- Update Results -->
              <div
                id="upc-update-results"
                style="display: none; margin-top: 1.5rem"
              >
                <div style="margin-bottom: 1rem">
                  <p
                    style="
                      margin: 0;
                      font-size: 0.875rem;
                      color: var(--text-secondary);
                    "
                  >
                    Update Summary:
                    <strong id="upc-update-count">0</strong> items updated
                  </p>
                </div>
                <div style="overflow-x: auto">
                  <table class="data-table">
                    <thead>
                      <tr>
                        <th>Store Name</th>
                        <th>Items Updated</th>
                        <th>Status</th>
                      </tr>
                    </thead>
                    <tbody id="upc-update-results-table-body">
                      <!-- Update results will be populated here by JavaScript -->
                    </tbody>
                  </table>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- History Page -->
        <div id="history-page" class="page" style="display: none">
          <header class="page-header">
            <h2>Update History</h2>
            <p class="subtitle">
              View all UPC barcode update operations across all stores
            </p>
          </header>

          <div class="settings-section">
            <!-- Filters Section -->
            <div class="history-filters" style="margin-bottom: 1.5rem">
              <div
                style="
                  display: grid;
                  grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
                  gap: 1rem;
                  margin-bottom: 1rem;
                "
              >
                <div class="form-group" style="margin: 0">
                  <label for="history-store-filter">Store</label>
                  <select id="history-store-filter" style="width: 100%">
                    <option value="">All Stores</option>
                  </select>
                </div>
                <div class="form-group" style="margin: 0">
                  <label for="history-upc-filter">UPC Search</label>
                  <input
                    type="text"
                    id="history-upc-filter"
                    placeholder="Search UPC..."
                    style="width: 100%"
                  />
                </div>
                <div class="form-group" style="margin: 0">
                  <label for="history-success-filter">Status</label>
                  <select id="history-success-filter" style="width: 100%">
                    <option value="">All</option>
                    <option value="true">Success Only</option>
                    <option value="false">Failed Only</option>
                  </select>
                </div>
                <div class="form-group" style="margin: 0">
                  <label for="history-start-date">Start Date</label>
                  <input
                    type="date"
                    id="history-start-date"
                    style="width: 100%"
                  />
                </div>
                <div class="form-group" style="margin: 0">
                  <label for="history-end-date">End Date</label>
                  <input
                    type="date"
                    id="history-end-date"
                    style="width: 100%"
                  />
                </div>
              </div>
              <div style="display: flex; gap: 0.75rem">
                <button
                  type="button"
                  class="btn btn-primary"
                  id="apply-history-filters-btn"
                >
                  Apply Filters
                </button>
                <button
                  type="button"
                  class="btn btn-secondary"
                  id="clear-history-filters-btn"
                >
                  Clear Filters
                </button>
              </div>
            </div>

            <!-- Loading State -->
            <div
              id="history-loading"
              class="test-status"
              style="display: none; margin-top: 1.5rem"
            >
              <div class="loading">Loading history...</div>
            </div>

            <!-- Empty State -->
            <div
              id="history-empty"
              style="
                display: none;
                text-align: center;
                padding: 3rem 1rem;
                color: var(--text-tertiary);
                margin-top: 1.5rem;
              "
            >
              <svg
                width="48"
                height="48"
                viewBox="0 0 48 48"
                fill="none"
                xmlns="http://www.w3.org/2000/svg"
                style="margin: 0 auto 1rem"
              >
                <path
                  d="M24 4L4 12V20C4 30 11 39 24 40C37 39 44 30 44 20V12L24 4Z"
                  stroke="currentColor"
                  stroke-width="2"
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  fill="none"
                />
              </svg>
              <p style="margin: 0; font-size: 0.875rem">
                No history records found
              </p>
              <p style="margin: 0.5rem 0 0; font-size: 0.75rem">
                Update history will appear here after you perform UPC updates
              </p>
            </div>

            <!-- Results Section -->
            <div id="history-results" style="display: none; margin-top: 1.5rem">
              <div
                style="
                  margin-bottom: 1rem;
                  display: flex;
                  justify-content: space-between;
                  align-items: center;
                "
              >
                <p
                  style="
                    margin: 0;
                    font-size: 0.875rem;
                    color: var(--text-secondary);
                  "
                >
                  <strong id="history-total-count">0</strong> records found
                </p>
                <div style="display: flex; gap: 0.5rem; align-items: center">
                  <label
                    for="history-page-size"
                    style="font-size: 0.875rem; color: var(--text-secondary)"
                    >Show:</label
                  >
                  <select
                    id="history-page-size"
                    style="padding: 0.25rem 0.5rem"
                  >
                    <option value="10">10</option>
                    <option value="25">25</option>
                    <option value="50" selected>50</option>
                    <option value="100">100</option>
                  </select>
                </div>
              </div>
              <div style="overflow-x: auto">
                <table class="data-table">
                  <thead>
                    <tr>
                      <th style="width: 5%">#</th>
                      <th style="width: 15%">Timestamp</th>
                      <th style="width: 18%">Store</th>
                      <th style="width: 25%">UPC Change</th>
                      <th style="width: 10%">Items</th>
                      <th style="width: 12%">Status</th>
                      <th style="width: 15%">Details</th>
                    </tr>
                  </thead>
                  <tbody id="history-results-table-body">
                    <!-- Results will be populated here by JavaScript -->
                  </tbody>
                </table>
              </div>

              <!-- Pagination Controls -->
              <div
                style="
                  margin-top: 1rem;
                  display: flex;
                  justify-content: space-between;
                  align-items: center;
                "
              >
                <button
                  type="button"
                  class="btn btn-secondary"
                  id="history-prev-btn"
                  disabled
                >
                  Previous
                </button>
                <span
                  id="history-page-info"
                  style="font-size: 0.875rem; color: var(--text-secondary)"
                >
                  Page 1
                </span>
                <button
                  type="button"
                  class="btn btn-secondary"
                  id="history-next-btn"
                  disabled
                >
                  Next
                </button>
              </div>
            </div>
          </div>
        </div>

        <!-- Orphan UPCs Page -->
        <div id="sql-audit-page" class="page" style="display: none">
          <header class="page-header">
            <h2>Orphan UPCs</h2>
            <p class="subtitle">
              Validate UPC data integrity by checking for orphaned UPCs in SQL
              databases
            </p>
          </header>

          <div class="settings-section">
            <!-- Store Selection -->
            <div class="form-group">
              <label for="audit-store-select">Select SQL Store to Audit</label>
              <div style="display: flex; gap: 0.75rem; align-items: stretch">
                <select id="audit-store-select" style="width: 300px">
                  <option value="">-- Select a store --</option>
                </select>
                <button
                  type="button"
                  class="btn btn-primary"
                  id="run-audit-btn"
                  disabled
                >
                  Run Audit
                </button>
              </div>
              <small
                style="
                  color: var(--text-tertiary);
                  font-size: 0.75rem;
                  margin-top: 0.5rem;
                  display: block;
                "
              >
                This audit will check all detail tables for UPCs that don't
                exist in the Items_tbl master catalog.
              </small>
            </div>

            <!-- Date Range Filter (Optional) -->
            <div class="form-group">
              <label>Date Range Filter (Optional)</label>
              <div style="display: flex; gap: 0.75rem; align-items: center">
                <div style="flex: 1">
                  <label
                    for="audit-date-from"
                    style="
                      font-size: 0.875rem;
                      margin-bottom: 0.25rem;
                      display: block;
                    "
                    >From Date</label
                  >
                  <input type="date" id="audit-date-from" style="width: 100%" />
                </div>
                <div style="flex: 1">
                  <label
                    for="audit-date-to"
                    style="
                      font-size: 0.875rem;
                      margin-bottom: 0.25rem;
                      display: block;
                    "
                    >To Date</label
                  >
                  <input type="date" id="audit-date-to" style="width: 100%" />
                </div>
              </div>
              <div style="display: flex; gap: 0.5rem; margin-top: 0.75rem">
                <button type="button" class="btn btn-secondary" id="audit-date-last-month" style="font-size: 0.75rem; padding: 0.375rem 0.75rem">
                  Last Month
                </button>
                <button type="button" class="btn btn-secondary" id="audit-date-this-month" style="font-size: 0.75rem; padding: 0.375rem 0.75rem">
                  This Month
                </button>
                <button type="button" class="btn btn-secondary" id="audit-date-clear" style="font-size: 0.75rem; padding: 0.375rem 0.75rem">
                  Clear Dates
                </button>
              </div>
              <small
                style="
                  color: var(--text-tertiary);
                  font-size: 0.75rem;
                  margin-top: 0.5rem;
                  display: block;
                "
              >
                Leave empty to audit all records. Provide dates to filter by
                transaction date from header tables.
              </small>
            </div>

            <!-- Cross-Database Comparison Option -->
            <div class="form-group">
              <label style="display: flex; align-items: center; gap: 0.5rem">
                <input
                  type="checkbox"
                  id="audit-cross-db-checkbox"
                  style="width: auto; margin: 0"
                />
                <span>Compare against different database</span>
              </label>
              <small
                style="
                  color: var(--text-tertiary);
                  font-size: 0.75rem;
                  margin-top: 0.5rem;
                  display: block;
                "
              >
                Check this option to find UPCs from the selected store that don't exist in a different database's Items_tbl.
              </small>
            </div>

            <!-- Target Database Dropdown (hidden by default) -->
            <div class="form-group" id="audit-target-db-group" style="display: none">
              <label for="audit-target-store-select">Target Database</label>
              <select id="audit-target-store-select" style="width: 300px">
                <option value="">-- Select target database --</option>
              </select>
              <small
                style="
                  color: var(--text-tertiary);
                  font-size: 0.75rem;
                  margin-top: 0.5rem;
                  display: block;
                "
              >
                Select which database's Items_tbl to check against. Only UPCs not found in this database will be reported.
              </small>
            </div>

            <!-- Loading State with Progress -->
            <div
              id="audit-loading"
              class="test-status"
              style="display: none; margin-top: 1.5rem"
            >
              <div class="loading">Running audit...</div>
              <div
                id="audit-progress"
                style="
                  margin-top: 1rem;
                  padding: 1rem;
                  background: var(--bg-tertiary);
                  border-radius: var(--radius-md);
                  display: none;
                  max-height: 200px;
                  overflow-y: auto;
                "
              >
                <div
                  id="audit-progress-items"
                  style="display: flex; flex-direction: column; gap: 0.5rem"
                ></div>
              </div>
            </div>

            <!-- Empty State -->
            <div
              id="audit-empty"
              style="
                display: none;
                text-align: center;
                padding: 3rem 1rem;
                color: var(--text-tertiary);
                margin-top: 1.5rem;
              "
            >
              <svg
                width="48"
                height="48"
                viewBox="0 0 48 48"
                fill="none"
                xmlns="http://www.w3.org/2000/svg"
                style="margin: 0 auto 1rem"
              >
                <path
                  d="M24 6L6 12V21C6 31.5 13.5 40.5 24 42C34.5 40.5 42 31.5 42 21V12L24 6Z"
                  stroke="currentColor"
                  stroke-width="2"
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  fill="none"
                />
                <path
                  d="M18 24L22 28.5L32 19.5"
                  stroke="currentColor"
                  stroke-width="2"
                  stroke-linecap="round"
                  stroke-linejoin="round"
                />
              </svg>
              <p style="margin: 0; font-size: 0.875rem; color: var(--success)">
                ✓ No orphaned UPCs found!
              </p>
              <p style="margin: 0.5rem 0 0; font-size: 0.75rem">
                All UPCs in detail tables are properly referenced in the Items
                catalog.
              </p>
            </div>

            <!-- Results Section -->
            <div id="audit-results" style="display: none; margin-top: 1.5rem">
              <div style="margin-bottom: 1rem">
                <p
                  style="
                    margin: 0;
                    font-size: 0.875rem;
                    color: var(--text-secondary);
                  "
                >
                  <strong id="audit-orphaned-count">0</strong>
                  <span id="audit-filter-text">
                    orphaned UPCs found across</span
                  >
                  <strong id="audit-tables-count">0</strong> tables
                </p>
              </div>

              <!-- Table Statistics Breakdown -->
              <div
                id="audit-statistics"
                style="
                  margin-bottom: 1rem;
                  display: none;
                  gap: 0.5rem;
                  flex-wrap: wrap;
                "
              >
                <!-- Statistics badges populated by JavaScript -->
              </div>

              <!-- Table Filter Dropdown -->
              <div class="form-group" style="margin-bottom: 1rem">
                <label for="audit-table-filter" style="font-size: 0.875rem"
                  >Filter by Table</label
                >
                <select id="audit-table-filter" style="max-width: 300px">
                  <option value="">All Tables</option>
                  <!-- Options populated by JavaScript -->
                </select>
              </div>

              <div style="overflow-x: auto">
                <table class="data-table">
                  <thead>
                    <tr>
                      <th style="width: 3%">
                        <input type="checkbox" id="select-all-orphans" />
                      </th>
                      <th style="width: 5%">#</th>
                      <th style="width: 25%">Table Name</th>
                      <th style="width: 15%">Record ID</th>
                      <th style="width: 20%">Orphaned UPC</th>
                      <th>Product Description</th>
                    </tr>
                  </thead>
                  <tbody id="audit-results-table-body">
                    <!-- Results will be populated here by JavaScript -->
                  </tbody>
                </table>
              </div>

              <!-- Export Button -->
              <div style="margin-top: 1rem">
                <button
                  type="button"
                  class="btn btn-secondary"
                  id="export-audit-btn"
                >
                  Export to Excel
                </button>
              </div>

              <!-- Reconciliation Actions -->
              <div
                id="reconciliation-actions"
                style="
                  display: none;
                  margin-top: 1rem;
                  display: flex;
                  gap: 0.75rem;
                "
              >
                <button
                  type="button"
                  class="btn btn-primary"
                  id="reconcile-by-product-id-btn"
                  disabled
                >
                  Find Matches by ProductID
                </button>
                <button
                  type="button"
                  class="btn btn-primary"
                  id="reconcile-by-description-btn"
                  disabled
                >
                  Find Matches by Description
                </button>
                <span
                  id="selection-count"
                  style="
                    margin-left: auto;
                    align-self: center;
                    color: var(--text-secondary);
                    font-size: 0.875rem;
                  "
                >
                  0 selected
                </span>
              </div>
            </div>
          </div>
        </div>

        <!-- Items Check Page -->
        <div id="store-comparison-page" class="page" style="display: none">
          <header class="page-header">
            <h2>Items Check</h2>
            <p class="subtitle">
              Compare Items_tbl between two MSSQL stores to find missing
              products
            </p>
          </header>

          <div class="card">
            <div class="card-header">
              <h3>Store Selection</h3>
            </div>

            <!-- Store Selection -->
            <div class="form-group">
              <label for="comparison-primary-store">Primary Store</label>
              <select id="comparison-primary-store" required>
                <option value="">Select primary store...</option>
              </select>
            </div>

            <div class="form-group">
              <label for="comparison-comparison-store">Comparison Store</label>
              <select id="comparison-comparison-store" required>
                <option value="">Select comparison store...</option>
              </select>
            </div>

            <!-- Filter Controls -->
            <div class="card-header" style="margin-top: 1.5rem">
              <h3>Filters (Optional)</h3>
            </div>

            <div class="form-group">
              <label for="comparison-categories">Categories</label>
              <select id="comparison-categories" multiple size="5">
                <option value="">Loading categories...</option>
              </select>
              <small style="color: var(--text-tertiary); font-size: 0.75rem">
                Hold Ctrl/Cmd to select multiple categories
              </small>
            </div>

            <div class="form-group">
              <label for="comparison-subcategories">Subcategories</label>
              <select id="comparison-subcategories" multiple size="5">
                <option value="">Select categories first...</option>
              </select>
              <small style="color: var(--text-tertiary); font-size: 0.75rem">
                Hold Ctrl/Cmd to select multiple subcategories
              </small>
            </div>

            <div class="form-group">
              <label style="display: flex; align-items: center; gap: 0.5rem">
                <input
                  type="checkbox"
                  id="comparison-include-discontinued"
                  style="width: auto; margin: 0"
                />
                <span>Include Discontinued Products</span>
              </label>
            </div>

            <!-- Run Button -->
            <div style="display: flex; gap: 0.75rem; margin-top: 1.5rem">
              <button
                type="button"
                class="btn btn-primary"
                id="run-comparison-btn"
                disabled
              >
                Run Comparison
              </button>
            </div>

            <!-- Loading State -->
            <div
              id="comparison-loading"
              class="loading-state"
              style="display: none; margin-top: 1.5rem"
            >
              <div class="spinner"></div>
              <p>Comparing stores...</p>
            </div>

            <!-- Progress Container -->
            <div
              id="comparison-progress-container"
              style="
                margin-top: 1rem;
                padding: 1rem;
                background: var(--bg-tertiary);
                border-radius: var(--radius-md);
                display: none;
                max-height: 200px;
                overflow-y: auto;
              "
            >
              <div
                id="comparison-progress-items"
                style="display: flex; flex-direction: column; gap: 0.5rem"
              ></div>
            </div>
          </div>

          <!-- Empty State -->
          <div
            id="comparison-empty"
            style="
              display: none;
              text-align: center;
              padding: 3rem 1rem;
              color: var(--text-tertiary);
              margin-top: 1.5rem;
            "
          >
            <svg
              width="48"
              height="48"
              viewBox="0 0 48 48"
              fill="none"
              xmlns="http://www.w3.org/2000/svg"
              style="margin: 0 auto 1rem"
            >
              <path
                d="M24 6L6 12V21C6 31.5 13.5 40.5 24 42C34.5 40.5 42 31.5 42 21V12L24 6Z"
                stroke="currentColor"
                stroke-width="2"
                stroke-linecap="round"
                stroke-linejoin="round"
                fill="none"
              />
              <path
                d="M18 24L22 28.5L32 19.5"
                stroke="currentColor"
                stroke-width="2"
                stroke-linecap="round"
                stroke-linejoin="round"
              />
            </svg>
            <p style="margin: 0; font-size: 0.875rem; color: var(--success)">
              ✓ All products from primary store exist in comparison store!
            </p>
            <p style="margin: 0.5rem 0 0; font-size: 0.75rem">
              No missing products found.
            </p>
          </div>

          <!-- Results Section -->
          <div
            id="comparison-results"
            style="display: none; margin-top: 1.5rem"
          >
            <div class="card">
              <div class="card-header">
                <h3>Missing Products</h3>
              </div>

              <div style="margin-bottom: 1rem">
                <p
                  style="
                    margin: 0;
                    font-size: 0.875rem;
                    color: var(--text-secondary);
                  "
                >
                  <strong id="comparison-missing-count">0</strong> products
                  missing out of
                  <strong id="comparison-checked-count">0</strong>
                  total products checked
                </p>
              </div>

              <!-- Category Statistics -->
              <div
                id="comparison-statistics"
                style="
                  margin-bottom: 1rem;
                  display: none;
                  gap: 0.5rem;
                  flex-wrap: wrap;
                "
              >
                <!-- Statistics badges populated by JavaScript -->
              </div>

              <!-- Category Filter Dropdown -->
              <div class="form-group" style="margin-bottom: 1rem">
                <label
                  for="comparison-category-filter"
                  style="font-size: 0.875rem"
                  >Filter by Category</label
                >
                <select
                  id="comparison-category-filter"
                  style="max-width: 300px"
                >
                  <option value="">All Categories</option>
                  <!-- Options populated by JavaScript -->
                </select>
              </div>

              <div style="overflow-x: auto">
                <table class="data-table">
                  <thead>
                    <tr>
                      <th style="width: 5%">#</th>
                      <th style="width: 10%">Product ID</th>
                      <th style="width: 15%">UPC</th>
                      <th style="width: 25%">Description</th>
                      <th style="width: 15%">Category</th>
                      <th style="width: 15%">Subcategory</th>
                      <th style="width: 10%">Status</th>
                    </tr>
                  </thead>
                  <tbody id="comparison-results-table-body">
                    <!-- Results will be populated here by JavaScript -->
                  </tbody>
                </table>
              </div>

              <!-- Export Button -->
              <div style="margin-top: 1rem">
                <button
                  type="button"
                  class="btn btn-secondary"
                  id="export-comparison-btn"
                >
                  Export to CSV
                </button>
              </div>
            </div>
          </div>
        </div>
      </main>
    </div>

    <!-- MSSQL Store Modal -->
    <div id="mssql-modal" class="modal">
      <div class="modal-content">
        <div class="modal-header">
          <h3>Add MSSQL Database</h3>
          <button class="modal-close" onclick="closeModal('mssql-modal')">
            &times;
          </button>
        </div>
        <form id="mssql-form" class="modal-form">
          <div class="form-group">
            <label for="mssql-name">Store Name</label>
            <input
              type="text"
              id="mssql-name"
              name="name"
              required
              placeholder="My Store Location"
            />
          </div>
          <div class="form-group">
            <label for="mssql-host">Host</label>
            <input
              type="text"
              id="mssql-host"
              name="host"
              required
              placeholder="localhost or IP address"
            />
          </div>
          <div class="form-group">
            <label for="mssql-port">Port</label>
            <input
              type="number"
              id="mssql-port"
              name="port"
              value="1433"
              required
            />
          </div>
          <div class="form-group">
            <label for="mssql-database">Database Name</label>
            <input
              type="text"
              id="mssql-database"
              name="database_name"
              required
              placeholder="database_name"
            />
          </div>
          <div class="form-group">
            <label for="mssql-username">Username</label>
            <input
              type="text"
              id="mssql-username"
              name="username"
              required
              placeholder="database_user"
            />
          </div>
          <div class="form-group">
            <label for="mssql-password">Password</label>
            <input
              type="password"
              id="mssql-password"
              name="password"
              required
              placeholder="••••••••"
            />
          </div>
          <div id="mssql-test-status" class="test-status"></div>
          <div class="modal-footer">
            <button
              type="button"
              class="btn btn-secondary"
              onclick="closeModal('mssql-modal')"
            >
              Cancel
            </button>
            <button type="button" class="btn btn-secondary" id="test-mssql-btn">
              Test Connection
            </button>
            <button type="submit" class="btn btn-primary">Add Database</button>
          </div>
        </form>
      </div>
    </div>

    <!-- Shopify Store Modal -->
    <div id="shopify-modal" class="modal">
      <div class="modal-content">
        <div class="modal-header">
          <h3>Add Shopify Store</h3>
          <button class="modal-close" onclick="closeModal('shopify-modal')">
            &times;
          </button>
        </div>
        <form id="shopify-form" class="modal-form">
          <div class="form-group">
            <label for="shopify-name">Store Name</label>
            <input
              type="text"
              id="shopify-name"
              name="name"
              required
              placeholder="My Shopify Store"
            />
          </div>
          <div class="form-group">
            <label for="shopify-domain">Shop Domain</label>
            <input
              type="text"
              id="shopify-domain"
              name="shop_domain"
              required
              placeholder="mystore.myshopify.com"
            />
          </div>
          <div class="form-group">
            <label for="shopify-api-key">Admin API Key</label>
            <input
              type="password"
              id="shopify-api-key"
              name="admin_api_key"
              required
              placeholder="shpat_..."
            />
          </div>
          <div class="form-group">
            <label for="shopify-version">API Version</label>
            <input
              type="text"
              id="shopify-version"
              name="api_version"
              value="2025-01"
              required
            />
            <small
              style="
                color: var(--text-tertiary);
                font-size: 0.75rem;
                margin-top: 0.25rem;
                display: block;
              "
              >Latest stable version. Shopify releases new versions
              quarterly.</small
            >
          </div>
          <div class="form-group">
            <label
              style="
                display: flex;
                align-items: center;
                cursor: pointer;
                user-select: none;
              "
            >
              <input
                type="checkbox"
                id="shopify-update-sku"
                name="update_sku_with_barcode"
                style="margin-right: 0.5rem"
              />
              <span>Update SKU to match barcode when updating UPCs</span>
            </label>
            <small
              style="
                color: var(--text-tertiary);
                font-size: 0.75rem;
                margin-top: 0.25rem;
                display: block;
              "
              >When enabled, the product variant SKU will be set to the same
              value as the barcode during UPC updates.</small
            >
          </div>
          <div id="shopify-test-status" class="test-status"></div>
          <div class="modal-footer">
            <button
              type="button"
              class="btn btn-secondary"
              onclick="closeModal('shopify-modal')"
            >
              Cancel
            </button>
            <button
              type="button"
              class="btn btn-secondary"
              id="test-shopify-btn"
            >
              Test Connection
            </button>
            <button type="submit" class="btn btn-primary">Add Store</button>
          </div>
        </form>
      </div>
    </div>

    <!-- Reconciliation Modal -->
    <div id="reconciliation-modal" class="modal">
      <div class="modal-content" style="max-width: 1200px; width: 95%">
        <div class="modal-header">
          <h3 id="reconciliation-modal-title">Reconciliation Results</h3>
          <button
            class="modal-close"
            onclick="closeModal('reconciliation-modal')"
          >
            &times;
          </button>
        </div>
        <div class="modal-body" style="padding: 1.5rem">
          <!-- Loading State with Progress -->
          <div
            id="reconciliation-loading"
            style="display: none; text-align: center; padding: 2rem"
          >
            <div class="loading">Finding matches...</div>
            <div
              id="reconciliation-progress"
              style="
                margin-top: 1rem;
                padding: 1rem;
                background: var(--bg-tertiary);
                border-radius: var(--radius-md);
                display: none;
                max-height: 200px;
                overflow-y: auto;
                text-align: left;
              "
            >
              <div
                id="reconciliation-progress-text"
                style="
                  font-size: 0.875rem;
                  color: var(--text-secondary);
                  margin-bottom: 0.5rem;
                "
              ></div>
            </div>
          </div>

          <!-- Results -->
          <div id="reconciliation-results" style="display: none">
            <div style="margin-bottom: 1rem">
              <p
                style="
                  margin: 0;
                  font-size: 0.875rem;
                  color: var(--text-secondary);
                "
              >
                <strong id="reconciliation-matched-count">0</strong> matched,
                <strong id="reconciliation-unmatched-count">0</strong> not
                matched
              </p>
            </div>
            <div style="overflow-x: auto; max-height: 400px">
              <table class="data-table" style="white-space: nowrap">
                <thead>
                  <tr>
                    <th style="width: 3%">
                      <input type="checkbox" id="select-all-matches" />
                    </th>
                    <th style="width: 18%">Table Name</th>
                    <th style="width: 10%">Record ID</th>
                    <th style="width: 18%">Orphaned UPC</th>
                    <th style="width: 18%">Matched UPC</th>
                    <th style="width: 10%">Status</th>
                    <th style="width: 23%">Match Field</th>
                  </tr>
                </thead>
                <tbody id="reconciliation-results-table-body">
                  <!-- Results will be populated here by JavaScript -->
                </tbody>
              </table>
            </div>
          </div>
        </div>
        <div class="modal-footer">
          <button
            type="button"
            class="btn btn-secondary"
            onclick="closeModal('reconciliation-modal')"
          >
            Cancel
          </button>
          <button
            type="button"
            class="btn btn-danger"
            id="cancel-reconciliation-btn"
            style="display: none"
          >
            Stop Operation
          </button>
          <button
            type="button"
            class="btn btn-primary"
            id="update-matched-upcs-btn"
            disabled
          >
            Update Selected Matches
          </button>
        </div>
      </div>
    </div>

    <script src="app.js"></script>
  </body>
</html>
